## タイトル
Python - AI : 勾配降下法の実装サンプル

## 目的
この記事では、勾配降下法についての実装サンプルを記載する。

## 概念の説明と実装サンプル
### 勾配法とは
下記の記事で**数値微分による勾配**と**偏微分による勾配**について解説したが、これらの**勾配**では、ある点を基準に実施した**勾配が示す方向**が分かっても**どの程度その方向に**進むと最小値（損失関数の結果が最小）に近づくかまで分からない。
- [Python - AI : 損失関数と数値微分（勾配）の実装サンプル](https://sigma-se.com/detail/24/)
- [Python - AI : 偏微分と勾配の実装サンプル](https://sigma-se.com/detail/25/)

そこでより正確な**最小値**を求めるために、この**勾配**を複数回実施して、その勾配が示す方向に基準をずらしながら**損失関数の結果が最小となる値**を探していく。

これを**勾配法**といい、最小値を探す**勾配降下法**と最大値を探す**勾配上昇法**に分類される。<br>
※ ニューラルネットワークの学習では、**勾配降下法**が多く用いられている。

ニューラルネットワークでも最適な**重み**や**バイアス**を学習時に決定するため、**勾配法**を用いて**損失関数の結果が最小となる値**を算出していくことになる。

変数が \\(x_{0}\\) と \\(x_{1}\\) の2つである場合を例に**勾配降下法**を数式で表現すると

<div style="display: flex; margin-left: 1rem; font-size: 1.2em; margin-top: -0.75em; overflow-x: auto; white-space: nowrap;">
\[
 x_{0} = x_{0} - μ\frac{∂\ (x_{0}, x_{1})}{∂x_{0}}\hspace{5mm}･･･（A）
\]
</div>
<div style="display: flex; margin-left: 1rem; font-size: 1.2em; margin-top: -0.75em; overflow-x: auto; white-space: nowrap;">
\[
 x_{1} = x_{1} - μ\frac{∂\ (x_{0}, x_{1})}{∂x_{1}}\hspace{5mm}･･･（B）
\]
</div>

と表せ、**\\(μ\\)** を**学習率**といい、複数回の勾配を実施するにあたって前回の勾配が示す方向へどのくらい進めるかの**基準値**となる。<br>
（勾配1回に対し、\\(（A）\\)と\\(（B）\\)をそれぞれ一回実施する。）

※ \\(\displaystyle \frac{∂\ (x_{0}, x_{1})}{∂x_{0}}\\) と \\(\displaystyle \frac{∂\ (x_{0}, x_{1})}{∂x_{1}}\\) の**偏微分**については、[Python - AI : 偏微分と勾配の実装サンプル > 勾配のPython実装サンプル](https://sigma-se.com/detail/25/#:~:text=%E3%81%AB%E9%81%8E%E3%81%8E%E3%81%AA%E3%81%84%E3%80%82-,%E5%8B%BE%E9%85%8D%E3%81%AEPython%E5%AE%9F%E8%A3%85%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB,-%E4%B8%8A%E8%A8%98%E3%81%A7%E3%80%81) を参考のこと。

- **学習率**についての補足<br>
下記の記事で触れている**重み**は、機械学習アルゴリズムにより自動で変化していくが、**学習率**は、あらかじめ人の手で設定するパラメータとなり、深層学習では勾配法によって、**最適化できない（しない）**パラメータになる。<br>
（このようなパラメータを**ハイパーパラメータ**という。）
  - [Python - AI : 単純パーセプトロンの概念と実装サンプル](https://sigma-se.com/detail/15/)
  - [Python - AI : 多層パーセプトロンの概念と実装サンプル](https://sigma-se.com/detail/16/)
  - [Python - AI : ニューラルネットワークの活性化関数と実装サンプル](https://sigma-se.com/detail/17/)

